var buttons = document.body.querySelectorAll('.buttons > button');
var output = document.querySelector('.window');
var operator = ['×', '÷', '-', '+', '%'];
var equation = '';
<<<<<<< HEAD
=======
var result = false;
var size = 0;
>>>>>>> a9ad1cd14acd22e715769dd532ee87135b6e3461

for (var i = 0; i < buttons.length; i++) {
	buttons[i].onclick = function(e) {
		var btnText = this.innerHTML;
		var size = output.innerHTML.length;
<<<<<<< HEAD
		if (size > 9) {
			oversize = true;
		} else {
			oversize = false;
		}
		if ((input == '0' && btnText != '.' && operator.indexOf(btnText) == -1) || input == 'NaN' || (result && operator.indexOf(btnText) == -1)) {
			result = false;
			input = '';
		}
		if (btnText === 'AC') {
			input = clearAC(input);
		} else if (btnText === 'CE') {
			input = clearCE(input.length, input);
		} else if (btnText === '.' && !oversize) {
			if (input.indexOf('.') === -1 || dotFlag) {
				input += '.';
				dotFlag = false;
			}
		} else if (btnText === '=') {
			result = true;
			input = calculate(input);
		} else {
			if (!oversize) {
				result = false;
				input += btnText;
			}
		}
		output.innerHTML = input;
	}
}

function clearAC(input) {
	operatorFlag = false;
	equation = '';
	return 0;
}

function clearCE(length, input) {
	if (length > 1) {
		return input.slice(0, input.length - 1);
	}
	return 0;
}

=======
		var input = output.innerHTML;
		input = errorHandling(btnText, input);
		output.innerHTML = calculator(btnText, size, input);
	}
}

function calculator(textButton, size, input){
	var oversize = false;
	if (size > 8) {
		oversize = true;
	}
	if (textButton === 'AC') {
		input = clearAC(input);
	} else if (textButton === 'CE') {
		input = clearCE(input.length, input);
	} else if (textButton === '.' && !oversize) {
			input += '.';
	} else if (textButton === '=') {
		input = calculate(input);
	} else {
		if (!oversize) {
			result = false;
			input += textButton;
		}
	}
	return String(input);
}

function errorHandling(textButton, input){
	if (input == '0' && textButton != '.' && operator.indexOf(textButton) == -1){
		size = 0;
		result = false;
		input = '';
	}else if (input == 'Err' || input == 'Lrg'){
		size = 0;
		result = false;
		input = '';
	}else if(result && operator.indexOf(textButton) == -1){
		size = 0;			
		result = false;
		input = '';
	}
	return input;	
}

function clearAC(input) {
	operatorFlag = false;
	equation = '';
	return '0';
}

function clearCE(length, input) {
	if (length > 1) {
		return input.slice(0, input.length - 1);
	}
	return '0';
}

>>>>>>> a9ad1cd14acd22e715769dd532ee87135b6e3461
function calculate(sequence) {
	equation = sequence.replace(/×/g, '*');
	equation = equation.replace(/÷/g, '/');
	try {
		var equal = Math.round(eval(equation) * 100) / 100;
<<<<<<< HEAD
		if (equal > 8) {
			return 'NumberTooLarge';
		} else {
			return equal;
		}
	} catch (error) {
		return 'NaN';
=======
		if (equation.length > 8) {
			result = false;
			return 'Lrg';
		} else {
			result = true;
			return String(equal);
		}
	} catch (error) {
		result = false;
		return 'Err';
>>>>>>> a9ad1cd14acd22e715769dd532ee87135b6e3461
	}
}

module.exports = {
	calculate,
	clearAC,
<<<<<<< HEAD
	clearCE
=======
	clearCE,
	calculator,
	errorHandling
>>>>>>> a9ad1cd14acd22e715769dd532ee87135b6e3461
}